
# [Platinum II] Apteka - 8571

[문제 링크](https://www.acmicpc.net/problem/8571)

### 문제 요약

<p> $N$명의 $C_i$값이 주어진다. 자리를 바꿀 때마다 문제에 정의된 데로 비용이 발생할 때, 맨 앞으로 가는 최소 비용을 구해보자. </p>

### 제한

TL : 1sec, ML : 512 MB

$1 ≤ N ≤ 10^6$

$1 ≤ C_i ≤ 10^9$

### 성능 요약

메모리: 36204 KB, 시간: 516 ms

### 분류

다이나믹 프로그래밍(dp) 볼록 껍질을 이용한 최적화(convex hull trick)

### comment

우선 문제를 다음과 같이 이해하면 편하다.

$Hansel$의 위치가 $0$ 번 인덱스이고, $1, 2, ... N$번 인덱스 사람들의 $C_i$가 주어진다.

자리 스왑마다 $Hansel$과 $i$가 떨어진 거리 * $C_i$ 의 비용이 발생 한다고 할 때 $Hansel$이 $N$번째 자리에 도달할 수 있는 최소 비용은 ?

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

다음과 같은 정의를 내려보자.

$dp[i]$ : $i$번째 위치에서 $N$번째 위치까지 도달하는 최소 비용.

그럼 이를 뒤에서부터 계산한다면 $i < j <= n$ 에서

$dp[i] = min(dp[i], (j - i) * a[j] + dp[j])$ 로 간단하게 점화식을 세워볼 수 있다.

이를 나이브하게 돌면 $O(N^2)$.

-----------------------------------------------------------------------------------------------------------------------------------------------------------------------

위 식에서 $i$를 $x$라 하면

$f(x) = -a[j] * x + j * a[j] + dp[j]$ 임에 따라

$-a[j]$의 기울기, $j * a[j] + dp[j]$의 절편을 갖는 직선의 방정식으로 나타낼 수 있다.

이제 컨벡스 헐 트릭을 적용할 수 있는 전형적인 형태가 보이니, 문제를 $O(N * logN)$에 해결할 수 있게 된다.
